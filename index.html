<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cloudflare Pages åŸŸåç®¡ç†</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
      color: white;
    }
    
    .header h1 {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 8px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .header p {
      font-size: 16px;
      opacity: 0.95;
    }
    
    .card {
      background: white;
      border-radius: 16px;
      padding: 28px;
      margin-bottom: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 48px rgba(0,0,0,0.15);
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .card-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 2px;
    }
    
    label {
      display: block;
      font-weight: 500;
      margin-bottom: 8px;
      color: #555;
      font-size: 14px;
    }
    
    input, select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.2s, box-shadow 0.2s;
      background: #fafafa;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      background: white;
    }
    
    button {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.danger {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      box-shadow: 0 4px 12px rgba(245, 87, 108, 0.3);
    }
    
    button.danger:hover {
      box-shadow: 0 6px 16px rgba(245, 87, 108, 0.4);
    }
    
    button.secondary {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3);
    }
    
    button.secondary:hover {
      box-shadow: 0 6px 16px rgba(79, 172, 254, 0.4);
    }
    
    pre {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-break: break-all;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      border: 1px solid #2d2d2d;
    }
    
    .hidden {
      display: none;
    }
    
    .input-group {
      margin-bottom: 20px;
    }
    
    .divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, #e0e0e0, transparent);
      margin: 24px 0;
    }
    
    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      background: #e8f5e9;
      color: #2e7d32;
      margin-left: auto;
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 28px;
      }
      
      body {
        padding: 20px 16px;
      }
    }
    
    .icon {
      width: 20px;
      height: 20px;
      display: inline-block;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .card {
      animation: fadeIn 0.4s ease-out;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>â˜ï¸ Cloudflare Pages</h1>
      <p>å¿«é€Ÿç®¡ç†è‡ªå®šä¹‰åŸŸåç»‘å®š</p>
    </div>
    
    <div class="card">
      <div class="card-title">è´¦æˆ·é…ç½®</div>
      <div class="input-group">
        <label>Account ID</label>
        <input type="text" id="accountId" placeholder="è¾“å…¥ä½ çš„ Cloudflare Account ID" />
      </div>
    </div>

    <div class="card hidden" id="projectSection">
      <div class="card-title">é¡¹ç›®ç®¡ç†</div>
      <div class="input-group">
        <label>é€‰æ‹© Pages é¡¹ç›®</label>
        <select id="projectSelect">
          <option value="">-- è¯·å…ˆåŠ è½½é¡¹ç›® --</option>
        </select>
      </div>
      <button class="secondary" onclick="loadProjects()">ğŸ”„ åŠ è½½é¡¹ç›®åˆ—è¡¨</button>
    </div>

    <div class="grid hidden" id="domainSection">
      <div class="card">
        <div class="card-title">âœ… æ·»åŠ åŸŸå</div>
        <div class="input-group">
          <label>è‡ªå®šä¹‰åŸŸå</label>
          <input type="text" id="addDomainInput" placeholder="example.com" />
        </div>
        <button onclick="addDomain()">æ·»åŠ åŸŸå</button>
      </div>

      <div class="card">
        <div class="card-title">ğŸ—‘ï¸ åˆ é™¤åŸŸå</div>
        <div class="input-group">
          <label>è¦åˆ é™¤çš„åŸŸå</label>
          <input type="text" id="removeDomainInput" placeholder="example.com" />
        </div>
        <button class="danger" onclick="removeDomain()">åˆ é™¤åŸŸå</button>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ğŸ“¡ API å“åº”</div>
      <pre id="output">ç­‰å¾…æ“ä½œ...</pre>
    </div>
  </div>

  <script>
    const accountIdInput = document.getElementById('accountId');
    const projectSection = document.getElementById('projectSection');
    const domainSection = document.getElementById('domainSection');
    const projectSelect = document.getElementById('projectSelect');
    const addDomainInput = document.getElementById('addDomainInput');
    const removeDomainInput = document.getElementById('removeDomainInput');
    const output = document.getElementById('output');

    accountIdInput.addEventListener('input', () => {
      if (accountIdInput.value.trim()) {
        projectSection.classList.remove('hidden');
      } else {
        projectSection.classList.add('hidden');
        domainSection.classList.add('hidden');
      }
    });

    async function apiCall(path, method = 'GET', body = null) {
      try {
        output.textContent = 'â³ è¯·æ±‚ä¸­...';
        const opts = {
          method,
          headers: { 'Content-Type': 'application/json' }
        };
        if (body) opts.body = JSON.stringify(body);
        
        const res = await fetch(path, opts);
        const data = await res.json();
        output.textContent = JSON.stringify(data, null, 2);
        return { ok: res.ok, data };
      } catch (e) {
        output.textContent = 'âŒ é”™è¯¯: ' + e.message;
        return { ok: false, data: null };
      }
    }

    async function loadProjects() {
      const accountId = accountIdInput.value.trim();
      if (!accountId) {
        alert('è¯·è¾“å…¥ Account ID');
        return;
      }

      const result = await apiCall(`/api/accounts/${accountId}/projects`);
      if (result.ok && result.data.success) {
        const projects = result.data.result || [];
        if (projects.length === 0) {
          projectSelect.innerHTML = '<option value="">æ²¡æœ‰æ‰¾åˆ°é¡¹ç›®</option>';
        } else {
          projectSelect.innerHTML = projects.map(p => 
            `<option value="${p.name}">${p.name}</option>`
          ).join('');
          domainSection.classList.remove('hidden');
        }
      }
    }

    async function addDomain() {
      const accountId = accountIdInput.value.trim();
      const projectName = projectSelect.value;
      const domain = addDomainInput.value.trim();
      
      if (!accountId || !projectName || !domain) {
        alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
        return;
      }

      const result = await apiCall(`/api/accounts/${accountId}/projects/${projectName}/domains`, 'POST', { 
        domain_name: domain 
      });
      
      if (result.ok && result.data.success) {
        addDomainInput.value = '';
        alert('âœ… åŸŸåæ·»åŠ æˆåŠŸï¼');
      }
    }

    async function removeDomain() {
      const accountId = accountIdInput.value.trim();
      const projectName = projectSelect.value;
      const domain = removeDomainInput.value.trim();
      
      if (!accountId || !projectName || !domain) {
        alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
        return;
      }

      if (!confirm(`ç¡®å®šè¦åˆ é™¤åŸŸå ${domain} å—ï¼Ÿ`)) {
        return;
      }

      const result = await apiCall(`/api/accounts/${accountId}/projects/${projectName}/domains/${domain}`, 'DELETE');
      
      if (result.ok && result.data.success) {
        removeDomainInput.value = '';
        alert('âœ… åŸŸååˆ é™¤æˆåŠŸï¼');
      }
    }
  </script>
</body>
</html>
